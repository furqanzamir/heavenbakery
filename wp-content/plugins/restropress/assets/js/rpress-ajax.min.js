var rpress_scripts;function rpress_load_gateway(payment_mode){jQuery(".rpress-cart-ajax").show(),jQuery("#rpress_purchase_form_wrap").html('<span class="rpress-loading-ajax rpress-loading"></span>');var url=rpress_scripts.ajaxurl;0<url.indexOf("?")?url+="&":url+="?",url=url+"payment-mode="+payment_mode,jQuery.post(url,{action:"rpress_load_gateway",rpress_payment_mode:payment_mode},function(response){jQuery("#rpress_purchase_form_wrap").html(response),jQuery(".rpress-no-js").hide(),jQuery("body").trigger("rpress_gateway_loaded",[payment_mode])})}jQuery(document).ready(function($){if($(".rpress-no-js").hide(),$("a.rpress-add-to-cart").addClass("rpress-has-js"),$(document.body).on("click.rpressRemoveFromCart",".rpress-remove-from-cart",function(event){var $this=$(this),item=$this.data("cart-item"),action=$this.data("action"),id=$this.data("fooditem-id"),data={action:action,cart_item:item};return $.ajax({type:"POST",data:data,dataType:"json",url:rpress_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(response){if(response.removed){if(parseInt(rpress_scripts.position_in_cart,10)===parseInt(item,10)||rpress_scripts.has_purchase_links)return window.location=window.location,!1;$(".rpress-cart").each(function(){$(this).find("[data-cart-item='"+item+"']").parent().remove()}),$(".rpress-cart").each(function(){var cart_item_counter=0;$(this).find("[data-cart-item]").each(function(){$(this).attr("data-cart-item",cart_item_counter),cart_item_counter+=1})}),$("[id^=rpress_purchase_"+id+"]").length&&($("[id^=rpress_purchase_"+id+"] .rpress_go_to_checkout").hide(),$("[id^=rpress_purchase_"+id+"] a.rpress-add-to-cart").show().removeAttr("data-rpress-loading"),"1"==rpress_scripts.quantities_enabled&&$("[id^=rpress_purchase_"+id+"] .rpress_fooditem_quantity_wrapper").show()),$("span.rpress-cart-quantity").text(response.cart_quantity),$(document.body).trigger("rpress_quantity_updated",[response.cart_quantity]),rpress_scripts.taxes_enabled&&($(".cart_item.rpress_subtotal span").html(response.subtotal),$(".cart_item.rpress_cart_tax span").html(response.tax)),$(".cart_item.rpress_total span").html(response.total),0==response.cart_quantity&&($(".cart_item.rpress_subtotal,.rpress-cart-number-of-items,.cart_item.rpress_checkout,.cart_item.rpress_cart_tax,.cart_item.rpress_total").hide(),$(".rpress-cart").each(function(){var cart_wrapper=$(this).parent();cart_wrapper&&(cart_wrapper.addClass("cart-empty"),cart_wrapper.removeClass("cart-not-empty")),$(this).append('<li class="cart_item empty">'+rpress_scripts.empty_cart_message+"</li>")})),$(document.body).trigger("rpress_cart_item_removed",[response])}}}).fail(function(response){window.console&&window.console.log&&console.log(response)}).done(function(response){}),!1}),$(document.body).on("click.rpressAddToCart",".rpress-add-to-cart",function(e){e.preventDefault();var $this=$(this),form=$this.closest("form");$this.prop("disabled",!0);$this.find(".rpress-loading");var container=$this.closest("div");$this.attr("data-rpress-loading","");form=$this.parents("form").last();var fooditem=$this.data("fooditem-id"),variable_price=$this.data("variable-price"),price_mode=$this.data("price-mode"),item_price_ids=[],free_items=!0;if("yes"==variable_price)if(0<form.find(".rpress_price_option_"+fooditem+'[type="hidden"]').length)item_price_ids[0]=$(".rpress_price_option_"+fooditem,form).val(),form.find(".rpress-submit").data("price")&&0<form.find(".rpress-submit").data("price")&&(free_items=!1);else{if(!form.find(".rpress_price_option_"+fooditem+":checked",form).length)return $this.removeAttr("data-rpress-loading"),alert(rpress_scripts.select_option),e.stopPropagation(),$this.prop("disabled",!1),!1;form.find(".rpress_price_option_"+fooditem+":checked",form).each(function(index){if(item_price_ids[index]=$(this).val(),!0===free_items){var item_price=$(this).data("price");item_price&&0<item_price&&(free_items=!1)}})}else item_price_ids[0]=fooditem,$this.data("price")&&0<$this.data("price")&&(free_items=!1);if(free_items&&form.find(".rpress_action_input").val("add_to_cart"),"straight_to_gateway"==form.find(".rpress_action_input").val())return form.submit(),!0;var data={action:$this.data("action"),fooditem_id:fooditem,price_ids:item_price_ids,post_data:$(form).serialize()};return $.ajax({type:"POST",data:data,dataType:"json",url:rpress_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(response){var store_redirect="1"==rpress_scripts.redirect_to_checkout,item_redirect="1"==form.find("#rpress_redirect_to_checkout").val();if(store_redirect&&item_redirect||!store_redirect&&item_redirect)window.location=rpress_scripts.checkout_page;else{"1"===rpress_scripts.taxes_enabled&&($(".cart_item.rpress_subtotal").show(),$(".cart_item.rpress_cart_tax").show()),$(".cart_item.rpress_total").show(),$(".cart_item.rpress_checkout").show(),$(".cart_item.empty").length&&$(".cart_item.empty").hide(),$(".widget_rpress_cart_widget .rpress-cart").each(function(cart){var target=$(this).find(".rpress-cart-meta:first");$(response.cart_item).insertBefore(target);var cart_wrapper=$(this).parent();cart_wrapper&&(cart_wrapper.addClass("cart-not-empty"),cart_wrapper.removeClass("cart-empty"))}),"1"===rpress_scripts.taxes_enabled&&($(".rpress-cart-meta.rpress_subtotal span").html(response.subtotal),$(".rpress-cart-meta.rpress_cart_tax span").html(response.tax)),$(".rpress-cart-meta.rpress_total span").html(response.total);$(".rpress-cart-item-title",response.cart_item).length;if($("span.rpress-cart-quantity").each(function(){$(this).text(response.cart_quantity),$(document.body).trigger("rpress_quantity_updated",[response.cart_quantity])}),"none"==$(".rpress-cart-number-of-items").css("display")&&$(".rpress-cart-number-of-items").show("slow"),"no"!=variable_price&&"multi"==price_mode||($("a.rpress-add-to-cart",container).toggle(),$(".rpress_go_to_checkout",container).css("display","inline-block")),"multi"==price_mode&&$this.removeAttr("data-rpress-loading"),$(".rpress_fooditem_purchase_form").length&&("no"==variable_price||!form.find(".rpress_price_option_"+fooditem).is("input:hidden"))){var parent_form=$('.rpress_fooditem_purchase_form *[data-fooditem-id="'+fooditem+'"]').parents("form");$("a.rpress-add-to-cart",parent_form).hide(),"multi"!=price_mode&&parent_form.find(".rpress_fooditem_quantity_wrapper").slideUp(),$(".rpress_go_to_checkout",parent_form).show().removeAttr("data-rpress-loading")}"incart"!=response&&($(".rpress-cart-added-alert",container).fadeIn(),setTimeout(function(){$(".rpress-cart-added-alert",container).fadeOut()},3e3)),$this.prop("disabled",!1),$(document.body).trigger("rpress_cart_item_added",[response])}}}).fail(function(response){window.console&&window.console.log&&console.log(response)}).done(function(response){}),!1}),$("#rpress_checkout_form_wrap").on("click",".rpress_checkout_register_login",function(){var data={action:$(this).data("action")};return $(".rpress-cart-ajax").show(),$.post(rpress_scripts.ajaxurl,data,function(checkout_response){$("#rpress_checkout_login_register").html(rpress_scripts.loading),$("#rpress_checkout_login_register").html(checkout_response),$(".rpress-cart-ajax").hide()}),!1}),$(document).on("click","#rpress_purchase_form #rpress_login_fields input[type=submit]",function(e){e.preventDefault();var complete_purchase_val=$(this).val();$(this).val(rpress_global_vars.purchase_loading),$(this).after('<span class="rpress-loading-ajax rpress-loading"></span>');var data={action:"rpress_process_checkout_login",rpress_ajax:1,rpress_user_login:$("#rpress_login_fields #rpress_user_login").val(),rpress_user_pass:$("#rpress_login_fields #rpress_user_pass").val()};$.post(rpress_global_vars.ajaxurl,data,function(data){"success"==$.trim(data)?($(".rpress_errors").remove(),window.location=rpress_scripts.checkout_page):($("#rpress_login_fields input[type=submit]").val(complete_purchase_val),$(".rpress-loading-ajax").remove(),$(".rpress_errors").remove(),$("#rpress-user-login-submit").before(data))})}),$("select#rpress-gateway, input.rpress-gateway").change(function(e){var payment_mode=$("#rpress-gateway option:selected, input.rpress-gateway:checked").val();return"0"==payment_mode||rpress_load_gateway(payment_mode),!1}),"1"==rpress_scripts.is_checkout){var chosen_gateway=!1,ajax_needed=!1;$("select#rpress-gateway, input.rpress-gateway").length&&(chosen_gateway=$("meta[name='rpress-chosen-gateway']").attr("content"),ajax_needed=!0),chosen_gateway||(chosen_gateway=rpress_scripts.default_gateway),ajax_needed?setTimeout(function(){rpress_load_gateway(chosen_gateway)},200):$("body").trigger("rpress_gateway_loaded",[chosen_gateway])}$(document).on("click","#rpress_purchase_form #rpress_purchase_submit [type=submit]",function(e){var rpressPurchaseform=document.getElementById("rpress_purchase_form");if("function"!=typeof rpressPurchaseform.checkValidity||!1!==rpressPurchaseform.checkValidity()){e.preventDefault();var complete_purchase_val=$(this).val();$(this).val(rpress_global_vars.purchase_loading),$(this).prop("disabled",!0),$(this).after('<span class="rpress-loading-ajax rpress-loading"></span>'),$.post(rpress_global_vars.ajaxurl,$("#rpress_purchase_form").serialize()+"&action=rpress_process_checkout&rpress_ajax=true",function(data){"success"==$.trim(data)?($(".rpress_errors").remove(),$(".rpress-error").hide(),$(rpressPurchaseform).submit()):($("#rpress-purchase-button").val(complete_purchase_val),$(".rpress-loading-ajax").remove(),$(".rpress_errors").remove(),$(".rpress-error").hide(),$(rpress_global_vars.checkout_error_anchor).before(data),$("#rpress-purchase-button").prop("disabled",!1),$(document.body).trigger("rpress_checkout_error",[data]))})}}),$(document.body).on("change","#rpress_cc_address input.card_state, #rpress_cc_address select, #rpress_address_country",function(){var $form,$this=$(this),is_checkout="undefined"!=typeof rpress_global_vars,field_name="card_state";"rpress_address_country"==$(this).attr("id")&&(field_name="rpress_address_state");if("card_state"!=$this.attr("id")){var postData={action:"rpress_get_shop_states",country:$this.val(),field_name:field_name};$.ajax({type:"POST",data:postData,url:rpress_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(response){$form=is_checkout?$("#rpress_purchase_form"):$this.closest("form");var state_inputs='input[name="card_state"], select[name="card_state"], input[name="rpress_address_state"], select[name="rpress_address_state"]';if("nostates"==$.trim(response)){$form.find(state_inputs).replaceWith('<input type="text" name="card_state" class="card-state rpress-input required" value=""/>')}else $form.find(state_inputs).replaceWith(response);is_checkout&&$(document.body).trigger("rpress_cart_billing_address_updated",[response])}}).fail(function(data){window.console&&window.console.log&&console.log(data)}).done(function(data){is_checkout&&recalculate_taxes()})}else is_checkout&&recalculate_taxes();return!1}),$(document.body).on("change","#rpress_cc_address input[name=card_zip]",function(){"undefined"!=typeof rpress_global_vars&&recalculate_taxes()})});